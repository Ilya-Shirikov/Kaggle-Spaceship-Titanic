# Космический корабль "Титаник"

Космический корабль "Титаник" был межзвездным пассажирским лайнером, запущенным месяц назад. С почти 13 000 пассажиров на борту, судно отлетело в свое первое плавание, перевозя эмигрантов из нашей Солнечной системы на три новые обитаемые экзопланеты, вращающиеся вокруг близлежащих звезд.
Во время обхода Альфа Центавра по пути к своему первому месту назначения - жаркому 55 Cancri E - неосвзойденный космический корабль Титаник сразился с пространствено-временной аномалией, скрытой в пылевом облаке. К сожалению, он встретил ту же судьбу, что и его тезка 1000 лет назад. Хотя корабль остался нетронутым, почти половина пассажиров была перевезена в другое измерение!


Чтобы помочь спасательным экипажам и вернуть потерянных пассажиров, нужно в этом соревновании предсказать, был ли пассажир перевезен в альтернативное измерение во время столкновения космического корабля «Титаник» с аномалией пространства-времени. Чтобы сделать эти прогнозы, нам предоставляется набор личных записей, извлеченных из поврежденной компьютерной системы корабля.

## **Цели:**

Предсказать, какие пассажиры переносятся в альтернативное измерение и предсказать Transported для пассажиров.

## **Метрики:**

Значение метрики качества Accuracy должно быть не менее 0.8


Так же цель попасть в ТОП-500.

## **Основные шаги**

 - Загрузить данные
 - Изучить данные
 - Заполните пропущенные значения и обработать аномалии в столбцах. Если среди признаков имеются неинформативные, удалим их.
 - Подготовьть выборки для обучения моделей.
 - Обучить разные модели, одна из которых — LightGBM, как минимум одна — не бустинг. Для каждой модели попробуем разные гиперпараметры.
 - Проанализировать время обучения, время предсказания и качество моделей.
 - Опираясь на критерии заказчика, выберем лучшую модель, проверим её качество на тестовой выборке.
 - Общий вывод


## **Используемые данные:**

- train.csv - Личные записи примерно для двух третей (~8700) пассажиров, которые будут использоваться в качестве тренировочных данных.
    
    - PassengerId - Уникальный ид для каждого пассажира. Каждый Id принимает форму gggg_pp, где gggg указывает на группу, с которой путешествует пассажир, и pp - это их номер в группе. Люди в группе часто являются членами семьи, но не всегда.
    - HomePlanet - Планета, с которой пассажир уехал, как правило, их планета постоянного проживания.
    - CryoSleep - Указывает, выбран ли пассажир криосон на время рейса. Пассажиры в криосне ограничены в своих каютах.
    - Cabin - Номер салона, в котором остановился пассажир. Принимает форму палубы/номер/боку, где сторона может быть либо P для порта, либо S для старого борта.
    - Destination - Планета, на которую будет доставлен пассажир.
    - Age - Возраст пассажира.
    - VIP - оплатил ли пассажир специальную VIP-услугу во время рейса.
    - RoomService, FoodCourt, ShoppingMall, Spa, VRDeck - Сумма, которую пассажиру выставили за каждый из многочисленных роскошных удобств космического корабля "Титаник".
    - Name - Имя и фамилия пассажира.
    - Transported - Был ли пассажир перевезен в другое измерение. Это цель, столбец, который вы пытаетесь предсказать.
    
    
- test.csv - Личные записи для оставшейся трети (~4300) пассажиров, которые будут использоваться в качестве тестовых данных. Ваша задача - предсказать стоимость Transported для пассажиров в этом наборе.
    
    
- sample_submission.csv - Файл отправки в правильном формате.
    
    - PassengerId- Ид. каждого пассажира в тестовом наборе.
    - Transported- Цель. Для каждого пассажира предскажите либо True, либо False.

### **Участие в соревнованиях Kaggle.**

Хочу поделиться опытом работы с задачей известного конкурса по машинному обучению от Kaggle. Конкурс «по титанику» был уже неоднократно отмечен на Хабре. Особенно хотелось бы отметить статью — оказывается, что исследование данных может быть не менее интригующим чем хороший детективный роман, а отличный результат (> 0.8) можно получить не только Random Forest или LogisticRegression классификатором.

Для решения задачи я использую Python-стек технологий. Этот подход не является единственно возможным: существуют R, Matlab, Mathematica, Azure Machine Learning, Apache Weka, Java-ML и я думаю список можно еще долго продолжать. Использование Python имеет ряд преимуществ: библиотек действительно много и они отличного качества, а поскольку большинство из них представляют собой обертки над C-кодом они еще и достаточно быстрые. К тому же построенная модель может быть легко запущена в эксплуатацию.

Вообще стоит отметить несколько моментов в подобных соревнованиях, которые показались мне интересными:

- Борьба в топе идет на сотые доли процентов — поэтому решает даже одна правильная или неправильная классификация из верификационного набора. Также на результат влияют случайные модификации параметров и алгоритма;
- Само соревнование несколько искусственно. В реальном мире у вас нет верификационного набора — только размеченная выборка на которой можно проводить кросс-валидацию, окончательное качество работы алгоритма оценивается как правило косвенно, например, по количеству жалоб пользователей;
- Не очень понятна максимальная степень качества оценки которую можно получить машинным обучением на задаче — размер обучающего набора не очень высок, а сам процесс неочевиден.

Можно и нужно сделать вывод, который я собираюсь применить в следующих конкурсах — необязательно (если это не запрещено правилами конкурса) ограничиваться только данными которые выдал организатор. Например по известному времени и месту можно выявить погодные условия, состояние рынков ценных бумаг, курсы валют, является ли день праздничным — другими словами можно поженить данные от организаторов с любыми доступными наборами публичных данных которые могут помочь в описании характеристик модели.
